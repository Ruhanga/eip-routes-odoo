<routes xmlns="http://camel.apache.org/schema/spring">

	<route id="odoo-create-quote" errorHandlerRef="watcherErrorHandler">
		<from uri="direct:odoo-create-quote" />

		<log message="Creating quotation in odoo..." />

		<setProperty name="xmlrpc-client-config">
			<spel>#{new org.apache.xmlrpc.client.XmlRpcClientConfigImpl()}</spel>
		</setProperty>
		<setProperty name="xmlrpc-client">
			<spel>#{new org.apache.xmlrpc.client.XmlRpcClient()}</spel>
		</setProperty>
		<script>
			<spel>
				#{getProperty('xmlrpc-client-config').setServerURL(new java.net.URL('{{odoo.baseUrl}}/xmlrpc/2/object'))}
			</spel>
		</script>
		<setProperty name="product-details">
			<spel>#{new java.util.HashMap(2)}</spel>
		</setProperty>
		<script>
			<spel>
				#{getProperty('product-details').put('product_id', 6)}
				#{getProperty('product-details').put('product_uom_qty', 2)}
			</spel>
		</script>
		<setProperty name="order-line-details">
			<spel>#{new java.util.ArrayList(3)}</spel>
		</setProperty>
		<script>
			<spel>
				#{getProperty('order-line-details').add(0)}
				#{getProperty('order-line-details').add('')}
				#{getProperty('order-line-details').add(getProperty('product-details'))}
			</spel>
		</script>
		<setProperty name="quote-data">
			<spel>#{new java.util.HashMap(3)}</spel>
		</setProperty>
		<script>
			<spel>
				#{getProperty('quote-data').put('partner_id', T(java.lang.Integer).valueOf(getProperty('odoo-id')))}
				#{getProperty('quote-data').put('order_line', T(java.util.Collections).singletonList(getProperty('order-line-details')))}
			</spel>
		</script>
		<setProperty name="create-quote-params">
			<spel>#{new java.util.ArrayList(6)}</spel>
		</setProperty>
		<script>
			<spel>
				#{getProperty('create-quote-params').add('{{odoo.database}}')}
				#{getProperty('create-quote-params').add(getProperty('odoo-user-id'))}
				#{getProperty('create-quote-params').add('{{odoo.password}}')}
				#{getProperty('create-quote-params').add('sale.order')}
				#{getProperty('create-quote-params').add('create')}
				#{getProperty('create-quote-params').add(T(java.util.Collections).singletonList(getProperty('quote-data')))}
			</spel>
		</script>
		<setBody>
			<spel>
				#{getProperty('xmlrpc-client').execute(getProperty('xmlrpc-client-config'), 'execute_kw', getProperty('create-quote-params'))}
			</spel>
		</setBody>

		<log message="Successfully created quote in odoo!" />
	</route>

</routes>