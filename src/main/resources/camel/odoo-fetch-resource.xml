<routes xmlns="http://camel.apache.org/schema/spring">

	<route id="odoo-fetch-resource" errorHandlerRef="watcherErrorHandler">
		<from uri="direct:odoo-fetch-resource" />

		<log message="Start: route with id ${routeId}" loggingLevel="DEBUG" />

        <choice>
            <when>
                <simple>${exchangeProperty.isSubResource} == true</simple>
                <setProperty name="resourceUrl">
                    <simple>{{openmrs.baseUrl}}/ws/rest/v1/${exchangeProperty.resourceName}/${exchangeProperty.resourceId}/${exchangeProperty.subResourceName}/${exchangeProperty.subResourceId}</simple>
                </setProperty>
            </when>
            <otherwise>
                <setProperty name="resourceUrl">
                    <simple>{{openmrs.baseUrl}}/ws/rest/v1/${exchangeProperty.resourceName}/${exchangeProperty.resourceId}</simple>
                </setProperty>
            </otherwise>
        </choice>

		<setBody>
			<simple>${null}</simple>
		</setBody>

		<toD uri="${exchangeProperty.resourceUrl}?httpMethod=GET&amp;authMethod=Basic&amp;authUsername={{openmrs.username}}&amp;authPassword={{openmrs.password}}" />

		<log message="End: route with id ${routeId}" loggingLevel="DEBUG" />
	</route>
</routes>