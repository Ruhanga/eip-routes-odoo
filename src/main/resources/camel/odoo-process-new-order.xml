<routes xmlns="http://camel.apache.org/schema/spring">

	<route id="odoo-process-new-order" errorHandlerRef="watcherErrorHandler">
		<from uri="direct:odoo-process-new-order" />

		<log message="Processing new order.." loggingLevel="DEBUG" />

		<when>
			<simple>${exchangeProperty.patient-odoo-id} == null</simple>
			<to uri="direct:odoo-fetch-patient" />

			<setProperty name="patient-name">
				<jsonpath>$.person.display</jsonpath>
			</setProperty>

			<to uri="direct:odoo-create-customer" />

			<setProperty name="patient-odoo-id">
				<simple>${body}</simple>
			</setProperty>

			<to uri="direct:odoo-save-identifier" />
		</when>

		<to uri="direct:odoo-create-quotation" />

		<log message="Successfully processed new order!" loggingLevel="DEBUG" />
	</route>

</routes>